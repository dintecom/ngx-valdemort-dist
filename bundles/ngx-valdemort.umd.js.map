{"version":3,"file":"ngx-valdemort.umd.js","sources":["ng://ngx-valdemort/lib/default-validation-errors.service.ts","ng://ngx-valdemort/lib/validation-error.directive.ts","ng://ngx-valdemort/lib/default-validation-errors.directive.ts","ng://ngx-valdemort/lib/valdemort-config.service.ts","ng://ngx-valdemort/lib/validation-errors.component.ts","ng://ngx-valdemort/lib/valdemort.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { ValidationErrorDirective } from './validation-error.directive';\n\n/**\n * Service used by the default validation errors directive to store the default error template references. This\n * service is injected in the validation errors component which displays the appropriate templates and provides their context.\n */\n@Injectable({\n  providedIn: 'root'\n})\nexport class DefaultValidationErrors {\n  directives: Array<ValidationErrorDirective> = [];\n}\n","/* tslint:disable:directive-selector */\n/* tslint:disable:no-input-rename */\nimport { Directive, Input, TemplateRef } from '@angular/core';\n\n/**\n * Directive allowing to define the template for an error of a given type (using the `valError` input), using an ng-template.\n * It's used inside the body of the validation errors component, or inside the body of the default validation errors directive.\n * See the documentation of these two for example usages.\n */\n@Directive({selector: 'ng-template[valError]'})\nexport class ValidationErrorDirective {\n  /**\n   * The type of the error that the content of the template must display.\n   */\n  @Input('valError') type: string;\n\n  constructor(public templateRef: TemplateRef<any>) { }\n}\n","/* tslint:disable:use-host-property-decorator */\n/* tslint:disable:directive-selector */\nimport { AfterContentInit, ContentChildren, Directive, QueryList } from '@angular/core';\nimport { DefaultValidationErrors } from './default-validation-errors.service';\nimport { ValidationErrorDirective } from './validation-error.directive';\n\n/**\n * Directive allowing to register default templates for validation error messages. It's supposed to be used once,\n * typically in the root component. By using templates to do that, error messages can\n * - easily be i18ned\n * - easily use pipes\n * - easily use HTML\n * - easily be ordered\n *\n * Example usage:\n * ```\n *   <val-default-errors>\n *     <ng-template valError=\"required\">This field is mandatory</ng-template>\n *     <ng-template valError=\"max\" let-error=\"error\">This field must be at most {{ error.max | number }}</ng-template>\n *   </val-default-errors>\n * ```\n *\n * Example usage where a label is used to make the messages less generic:\n * ```\n *   <val-default-errors>\n *     <ng-template valError=\"required\" let-label>{{ label }} is mandatory</ng-template>\n *     <ng-template valError=\"max\" let-error=\"error\" let-label>{{ label }} must be at most {{ error.max | number }}</ng-template>\n *   </val-default-errors>\n * ```\n *\n * This directive stores the default template references in a service, that is then injected in the validation errors components\n * to be reused.\n */\n@Directive({\n  selector: 'val-default-errors',\n  host: {\n    style: 'display: none'\n  }\n})\nexport class DefaultValidationErrorsDirective implements AfterContentInit {\n\n  constructor(private defaultValidationErrors: DefaultValidationErrors) { }\n\n  /**\n   * The list of validation error directives (i.e. <ng-template valError=\"...\">)\n   * contained inside the component element.\n   */\n  @ContentChildren(ValidationErrorDirective)\n  errorDirectives: QueryList<ValidationErrorDirective>;\n\n  ngAfterContentInit() {\n    this.defaultValidationErrors.directives = this.errorDirectives.toArray();\n  }\n}\n\n","import { Injectable } from '@angular/core';\nimport { AbstractControl, ControlContainer, FormGroupDirective, NgForm } from '@angular/forms';\n\n/**\n * The display mode of the validation errors. For a given control, either all the validation errors\n * are displayed, or only the first one.\n */\nexport enum DisplayMode {\n  ALL, ONE\n}\n\n/**\n * The configuration service used by the validation errors component to apply common rules for all\n * form controls.\n *\n * To change its default behavior, you can either inject this service in your root module or component and mutate it,\n * or define your own implementation and provide it.\n */\n@Injectable({\n  providedIn: 'root'\n})\nexport class ValdemortConfig {\n\n  /**\n   * The display mode of the errors. The default value is ALL, meaning that all the errors existing on a control\n   * (and which have an error template defined) are displayed.\n   */\n  displayMode = DisplayMode.ALL;\n\n  /**\n   * Specifies one or several CSS classes (separated by a white space) that are automatically added to the\n   * validation errors element. This can be useful to reuse a standard CSS class of your CSS framework (like\n   * .invalid-feedback in BootStrap), rather than styling the val-errors element itself.\n   *\n   * The default value is null (no class is added).\n   */\n  errorsClasses: string | null = null;\n\n  /**\n   * Specifies one or several CSS classes (separated by a white space) that are automatically added to the\n   * each validation error message element. This can be useful to reuse a standard CSS class of your CSS framework\n   * rather than styling the div element itself.\n   *\n   * The default value is null (no class is added).\n   */\n  errorClasses: string | null = null;\n\n  /**\n   * Specifies when error messages should be displayed. based on the state of the control itself (touched, dirty, etc.)\n   * and on the state of the form directive containing it (if any). This function is only called if the control is invalid\n   * in the first place: if it's valid, errors are never displayed.\n   *\n   * The default value of this function returns true if the control is touched, or if the form (if any) is submitted.\n   */\n  shouldDisplayErrors = (control: AbstractControl, form: NgForm | FormGroupDirective | undefined) =>\n    control.touched || (!!form && form.submitted)\n}\n","/* tslint:disable:use-host-property-decorator */\nimport { Component, ContentChildren, Input, Optional, QueryList } from '@angular/core';\nimport { AbstractControl, ControlContainer, FormArray, FormGroup, FormGroupDirective, NgForm } from '@angular/forms';\nimport { ValdemortConfig, DisplayMode } from './valdemort-config.service';\nimport { DefaultValidationErrors } from './default-validation-errors.service';\nimport { ValidationErrorDirective } from './validation-error.directive';\n\n/**\n * Component allowing to display validation error messages associated to a given form control, form group or form array.\n * The control is provided using the `control` input of the component. If it's used inside an enclosing form group or\n * form array, it can instead be provided using the `controlName` input of the component.\n *\n * Example usage where the control itself is being passed as input:\n * ```\n *   <val-errors [control]=\"form.get('birthDate')\">\n *     <ng-template valError=\"required\">The birth date is mandatory</ng-template>\n *     <ng-template valError=\"max\" let-error=\"error\">The max value for the birth date is {{ error.max | number }}</ng-template>\n *   </val-errors>\n * ```\n *\n * Example usage where the control name is being passed as input:\n * ```\n *   <val-errors controlName=\"birthDate\">\n *     <ng-template valError=\"required\">The birth date is mandatory</ng-template>\n *     <ng-template valError=\"max\" let-error=\"error\">The max value for the birth date is {{ error.max | number }}</ng-template>\n *   </val-errors>\n * ```\n *\n * This component, if the control is invalid, displays its validation errors using the provided templates.\n * The templates, as shown in the above example, have access to the validation error itself.\n *\n * The label of the control can also be provided as input, and then used in the templates:\n * ```\n *   <val-errors controlName=\"birthDate\" label=\"the birth date\">\n *     <ng-template valError=\"required\" let-label>{{ label }} is mandatory</ng-template>\n *     <ng-template valError=\"max\" let-error=\"error\" let-label>The max value for {{ label }} is {{ error.max | number }}</ng-template>\n *   </val-errors>\n * ```\n *\n * The componentâs behavior is configured globally by the Config service (see its documentation for more details). It can\n * - display the first error, or all the errors\n * - add CSS classes to its host `<val-errors>` element\n * - add CSS classes to each error message element being displayed\n * - choose when to display the errors (dirty, touched, touched and submitted, etc.)\n *\n * Global, default templates can be defined (and used by this component) using the default validation errors directive\n * (see its documentation for details). So, if the default error messages are defined and sufficient for a given control, all you\n * need is\n *\n * ```\n * <val-errors controlName=\"birthDate\"></val-errors>\n * ```\n *\n * or, if the default templates expect a label:\n *\n * ```\n * <val-errors controlName=\"birthDate\" label=\"the birth date\"></val-errors>\n * ```\n *\n * If, however, you want to override one or several error messages by custom ones, you can do so by simply defining them inside the\n * component:\n *\n * ```\n * <val-errors controlName=\"birthDate\" label=\"the birth date\">\n *   <ng-template valError=\"max\">You're too young, sorry</ng-template>\n * </val-errors>\n * ```\n *\n * If an error is present on the control, but doesn't have any template or default template defined for its type, then it's not\n * displayed. If the control is valid, or if none of the errors of the component has a matching template or default template,\n * then this component itself is hidden.\n */\n@Component({\n  selector: 'val-errors',\n  templateUrl: './validation-errors.component.html',\n  host: {\n    '[class]': 'errorsClasses',\n    '[style.display]': `shouldDisplayErrors ? '' : 'none'`\n  }\n})\nexport class ValidationErrorsComponent {\n\n  /**\n   * The FormControl, FormGroup or FormArray containing the validation errors.\n   * If set, the controlName input is ignored\n   */\n  @Input()\n  control: AbstractControl;\n\n  /**\n   * The name (or the index, in case it's contained in a FormArray) of the FormControl, FormGroup or FormArray containing the validation\n   * errors.\n   * Ignored if the control input is set, and only usable if the control to validate is part of a control container\n   */\n  @Input()\n  controlName: string | number;\n\n  /**\n   * The label of the field, exposed to templates so they can use it in the error message.\n   */\n  @Input()\n  label: string;\n\n  /**\n   * The list of validation error directives (i.e. <ng-template valError=\"...\">) contained inside the component element.\n   */\n  @ContentChildren(ValidationErrorDirective)\n  errorDirectives!: QueryList<ValidationErrorDirective>;\n\n  /**\n   * @param config the Config service instance, defining the behavior of this component\n   * @param defaultValidationErrors the service holding the default error templates, optionally\n   * defined by using the default validation errors directive\n   * @param controlContainer one of the 4 form group or form array directives that can \"wrap\" the control.\n   * It's injected so that we can know if it exists and, if it does, if its form directive has been submitted or not:\n   * the config service shouldDisplayErrors function can choose (and does by default) to use that information.\n   */\n  constructor(private config: ValdemortConfig,\n              private defaultValidationErrors: DefaultValidationErrors,\n              @Optional() private controlContainer: ControlContainer) { }\n\n  get shouldDisplayErrors() {\n    const ctrl = this.actualControl;\n    if (!ctrl || !ctrl.invalid || !this.hasDisplayableError(ctrl)) {\n      return false;\n    }\n    const form = this.controlContainer && (this.controlContainer.formDirective as NgForm | FormGroupDirective);\n    return this.config.shouldDisplayErrors(ctrl, form);\n  }\n\n  get errorsClasses(): string {\n    return this.config.errorsClasses || '';\n  }\n\n  get errorClasses(): string {\n    return this.config.errorClasses || '';\n  }\n\n  get errorDirectivesToDisplay() {\n    const mergedDirectives: Array<ValidationErrorDirective> = [];\n    const alreadyMetTypes = new Set<string>();\n    const shouldContinue = () => (this.config.displayMode === DisplayMode.ALL || mergedDirectives.length === 0);\n    const ctrl = this.actualControl;\n    for (let i = 0; i < this.defaultValidationErrors.directives.length && shouldContinue(); i++) {\n      const defaultDirective = this.defaultValidationErrors.directives[i];\n      alreadyMetTypes.add(defaultDirective.type);\n      if (ctrl.hasError(defaultDirective.type)) {\n        const customDirectiveOfSameType = this.errorDirectives.find(dir => dir.type === defaultDirective.type);\n        mergedDirectives.push(customDirectiveOfSameType || defaultDirective);\n      }\n    }\n\n    const customDirectives = this.errorDirectives.toArray();\n    for (let i = 0; i < customDirectives.length && shouldContinue(); i++) {\n      const customDirective = customDirectives[i];\n      if (ctrl.hasError(customDirective.type) && !alreadyMetTypes.has(customDirective.type)) {\n        mergedDirectives.push(customDirective);\n      }\n    }\n    return mergedDirectives;\n  }\n\n  get actualControl(): AbstractControl {\n    return this.control ||\n      ((this.controlName || (this.controlName as any === 0)) &&\n        this.controlContainer &&\n        this.controlContainer.control &&\n        ((this.controlContainer.control as FormGroup | FormArray).controls as any)[this.controlName]);\n  }\n\n  private hasDisplayableError(ctrl: AbstractControl) {\n    return ctrl.errors && Object.keys(ctrl.errors).some(type =>\n      this.defaultValidationErrors.directives.some(dir => dir.type === type)\n      || this.errorDirectives.some(dir => dir.type === type)\n    );\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { ValidationErrorsComponent } from './validation-errors.component';\nimport { CommonModule } from '@angular/common';\nimport { DefaultValidationErrorsDirective } from './default-validation-errors.directive';\nimport { ValidationErrorDirective } from './validation-error.directive';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [\n    ValidationErrorsComponent,\n    ValidationErrorDirective,\n    DefaultValidationErrorsDirective\n  ],\n  exports: [\n    ValidationErrorsComponent,\n    ValidationErrorDirective,\n    DefaultValidationErrorsDirective\n  ]\n})\nexport class ValdemortModule { }\n"],"names":["Injectable","Directive","TemplateRef","Input","ContentChildren","Component","ControlContainer","Optional","NgModule","CommonModule"],"mappings":"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"}